class ddomr{async init(e){var t=document;let r=new URLSearchParams(document.location.search.substring(1)).get("routing");r&&(e=r);const a=await(await fetch(e)).text();window.history.pushState({html:a,pageTitle:"DDOMR Page"},"",e),t.querySelector("html").innerHTML=a;var o=1;Array.from(t.querySelectorAll("ddomr-template")).forEach(async function(e){o++,(new ddomr).loadFromTemplate(e.getAttribute("template-src"),t,e).then(()=>{o===t.querySelectorAll("ddomr-template").length&&(new ddomr).jsreload(t)})}),window.addEventListener("popstate",e=>{this.change(document.location.href,document)})}async change(e){var t=document;const r=await(await fetch(e)).text();window.history.pushState({html:r},"",e),t.querySelector("html").innerHTML=r;var a=1;Array.from(t.querySelectorAll("ddomr-template")).forEach(async function(e){a++,(new ddomr).loadFromTemplate(e.getAttribute("template-src"),t,e).then(()=>{a===t.querySelectorAll("ddomr-template").length&&(new ddomr).jsreload(t)})})}async jsreload(doc){Array.from(doc.querySelectorAll("script.ddomr-script")).forEach(async function(element){element.hasAttribute("src")?eval(await(await fetch(element.src)).text()):eval(element.innerHTML)})}async loadFromTemplate(e,t,r){t||console.error("DDOMR: Invalid document variable");var a=new DOMParser,o=await(await fetch(e)).text(),l=a.parseFromString(o,"text/html");if(!l)return console.error("DDOMR: Could not find template at path: "+e);var n=l.querySelector("template")?l.querySelector("template").innerHTML:null;return n?(r.innerHTML=n,Array.from(r.querySelectorAll("ddomr-template")).forEach(async function(e){(new ddomr).loadFromTemplate(e.getAttribute("template-src"),r,e)}),r):console.error("DDOMR: Failed to locate template content in specified template path at: "+e)}}